wp.customize.Posts.NavMenusExtensions=function(a,b){"use strict";var c={};return a.Menus.insertAutoDraftPost&&(a.Menus.insertAutoDraftPost=function(c){var d,e=b.Deferred();return d=a.Posts.insertAutoDraftPost(c.post_type),d.done(function(b){var d;d=_.clone(b.setting.get()),d.post_title=c.post_title,d.post_status="publish",b.setting.set(d),e.resolve({post_id:b.postId,url:a.Posts.getPostUrl({post_id:b.postId,post_type:c.post_type})})}),d.fail(function(a){e.reject(a)}),e.promise()}),c.addEditPostButton=function(c){var d,e,f=c.setting.get();"post_type"===f.type&&f.object_id&&(d=a.Posts.data.postTypes[f.object],d&&d.current_user_can.edit_published_posts&&(e=b(wp.template("customize-posts-edit-nav-menu-item-original-object")({editItemLabel:d.labels.edit_item})),e.on("click",function(){a.Posts.startEditPostFlow({postId:f.object_id,initiatingButton:e,originatingConstruct:c,restorePreviousUrl:!0,returnToOriginatingConstruct:!0})}),c.container.find(".menu-item-actions > .link-to-original").append(e)))},c.syncOriginalItemTitle=function(c){var d,e,f=c.setting.get();"post_type"===f.type&&f.object_id&&(d=a.Posts.data.postTypes[f.object],d&&(e="post["+String(f.object)+"]["+String(f.object_id)+"]",a(e,function(d){var e=function(d,e){var f,g;e&&d.post_title===e.post_title||(f=b.trim(d.post_title)||a.Posts.data.l10n.noTitle),"resolved"===c.deferred.embedded.state()&&(c.container.find(".menu-item-actions > .link-to-original > .original-link").text(f),c.container.find(".edit-menu-item-title:first").attr("placeholder",f)),g=_.clone(c.setting.get()),g.original_title=d.post_title,g.title?c.setting._value=g:c.setting.set(g)};d.bind(e),e(d.get(),null)})))},c.extendNavMenuItemOriginalObjectReference=function(b){var d;b.extended(a.Menus.MenuItemControl)&&(c.syncOriginalItemTitle(b),d=function(a){a&&(b.expanded.unbind(d),c.addEditPostButton(b))},b.deferred.embedded.done(function(){b.expanded.get()?d():b.expanded.bind(d)}))},c.watchPostSettingChanges=function(c){var d,e,f,g,h,i,j,k;j="post[",j===c.id.substr(0,j.length)&&(d=c.id.substr(j.length).replace(/]/g,"").split("["),e=parseInt(d[1],10),e&&(g=c.get().post_title||a.Posts.data.l10n.noTitle,i="post-"+String(e),k=b("#menu-item-tpl-"+i),k.length&&(f=k.find(".menu-item-title:first"),b.trim(g)!==b.trim(f.text())&&f.text(g),"publish"!==c.get().post_status&&k.is(":visible")?k.hide():"publish"!==c.get().post_status||k.is(":visible")||k.show()),h=a.Menus.availableMenuItemsPanel.collection.get(i),h&&h.set("title",g)))},c.ajaxPrefilterAvailableNavMenuItemRequests=function(c){var d;"POST"===c.type.toUpperCase()&&(d=document.createElement("a"),d.href=c.url,/wp-admin\/admin-ajax\.php$/.test(d.pathname)&&/(^|&)action=(search-available-menu-items-customizer|load-available-menu-items-customizer)(&|$)/.test(c.data)&&(c.data+="&",c.data+=b.param({customized:a.previewer.query().customized})))},a.control.each(c.extendNavMenuItemOriginalObjectReference),a.control.bind("add",c.extendNavMenuItemOriginalObjectReference),a.bind("change",c.watchPostSettingChanges),b.ajaxPrefilter(c.ajaxPrefilterAvailableNavMenuItemRequests),c}(wp.customize,jQuery);